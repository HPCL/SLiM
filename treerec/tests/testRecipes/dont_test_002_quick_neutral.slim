// quick neutral.slim : ^Total mutation frequencies: (.*)$
//
// A test script with a quick, vanilla neutral simulation; this is the SLiMgui default model
//
initialize() {
    // TREE SEQUENCE TEST OUTPUT
    initializeSLiMOptions(treeRecordingPath="treeseq.txt");
    source("testing_utils.slim");
    defineConstant("n_marks",20);   // number of marked genomes
    initializeMarkedMutations(n_marks);

	initializeGenomicElementType("g1", m1, 1.0);
    initializeGenomicElement(g1, 0, 9);
    initializeMutationRate(0.0);
    initializeRecombinationRate(0.2);    
}
1 {
	sim.addSubpop("p1", 500);
    
    // TREE SEQUENCE TEST OUTPUT
    initializeMarks(sim, n_marks);
}
10 late() { p1.outputSample(10); }
20 late() { p1.outputSample(10); }
20 late() { sim.outputFixedMutations(); }
20 late() { cat("\nTotal mutation frequencies: " + sum(sim.mutationFrequencies(NULL)) + "\n"); }
20 late() {
    // TREE SEQUENCE TEST OUTPUT
    outputMutationResult(sim);
}
